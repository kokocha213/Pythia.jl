<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Stationarity and detrending (ADF/KPSS) · Pythia.jl</title><meta name="title" content="Stationarity and detrending (ADF/KPSS) · Pythia.jl"/><meta property="og:title" content="Stationarity and detrending (ADF/KPSS) · Pythia.jl"/><meta property="twitter:title" content="Stationarity and detrending (ADF/KPSS) · Pythia.jl"/><meta name="description" content="Documentation for Pythia.jl."/><meta property="og:description" content="Documentation for Pythia.jl."/><meta property="twitter:description" content="Documentation for Pythia.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Pythia.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../arma_generated/">Autoregressive Moving Average (ARMA): Artificial data</a></li><li><a class="tocitem" href="../arma_sunspots/">Autoregressive Moving Average (ARMA): Sunspots data</a></li><li class="is-active"><a class="tocitem" href>Stationarity and detrending (ADF/KPSS)</a><ul class="internal"><li><a class="tocitem" href="#Stationarity-tests"><span>Stationarity tests</span></a></li><li><a class="tocitem" href="#Detrending-by-Differencing"><span>Detrending by Differencing</span></a></li><li><a class="tocitem" href="#Conclusion"><span>Conclusion</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Stationarity and detrending (ADF/KPSS)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Stationarity and detrending (ADF/KPSS)</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ababii/Pythia.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Stationarity-and-detrending-(ADF/KPSS)"><a class="docs-heading-anchor" href="#Stationarity-and-detrending-(ADF/KPSS)">Stationarity and detrending (ADF/KPSS)</a><a id="Stationarity-and-detrending-(ADF/KPSS)-1"></a><a class="docs-heading-anchor-permalink" href="#Stationarity-and-detrending-(ADF/KPSS)" title="Permalink"></a></h1><p>Stationarity means that the statistical properties of a time series i.e. mean, variance and covariance do not change over time. Many statistical models require the series to be stationary to make effective and precise predictions.</p><p>Two statistical tests would be used to check the stationarity of a time series – Augmented Dickey Fuller (“ADF”) test and Kwiatkowski-Phillips-Schmidt-Shin (“KPSS”) test. A method to convert a non-stationary time series into stationary series shall also be used.</p><p>This first cell imports standard packages and sets plots to appear inline.</p><pre><code class="language-julia hljs">using Pythia,Plots</code></pre><p>Sunspots dataset is used. It contains yearly (1700-2008) data on sunspots from the National Geophysical Data Center.</p><pre><code class="language-julia hljs">sun_data = load_dataset(&quot;sunspots&quot;)
years = round.(Int, sun_data.Year)
ssn   = sun_data.SSN</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">309-element Vector{Float64}:
   5.0
  11.0
  16.0
  23.0
  36.0
  58.0
  29.0
  20.0
  10.0
   8.0
   ⋮
 119.6
 111.0
 104.0
  63.7
  40.4
  29.8
  15.2
   7.5
   2.9</code></pre><p>The data is plotted now.</p><pre><code class="language-julia hljs">plot(
    years,
    ssn,
    xlabel = &quot;Year&quot;,
    ylabel = &quot;Sunspot Number (SSN)&quot;,
    title = &quot;Yearly Sunspot Activity&quot;,
    lw = 2,
    legend = false,
    size = (1200, 800)
)</code></pre><img src="80b737eb.svg" alt="Example block output"/><h2 id="Stationarity-tests"><a class="docs-heading-anchor" href="#Stationarity-tests">Stationarity tests</a><a id="Stationarity-tests-1"></a><a class="docs-heading-anchor-permalink" href="#Stationarity-tests" title="Permalink"></a></h2><p>KPSS is a test for checking the stationarity of a time series.</p><p>Null Hypothesis: The process is trend stationary.</p><p>Alternate Hypothesis: The series has a unit root (series is not stationary).</p><pre><code class="language-julia hljs">kpss_test(ssn)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(statistic = 0.5841438018794799, pvalue = 0.0006743255690845329, lags = 5, critical_values = Dict(&quot;5%&quot; =&gt; 0.463, &quot;10%&quot; =&gt; 0.347, &quot;1%&quot; =&gt; 0.739))</code></pre><p>Based upon the significance level of 0.05 and the p-value of KPSS test, there is evidence for rejecting the null hypothesis in favor of the alternative. Hence, the series is non-stationary as per the KPSS test.</p><p>ADF test is used to determine the presence of unit root in the series, and hence helps in understand if the series is stationary or not. The null and alternate hypothesis of this test are:</p><p>Null Hypothesis: The series has a unit root.</p><p>Alternate Hypothesis: The series has no unit root.</p><p>If the null hypothesis in failed to be rejected, this test may provide evidence that the series is non-stationary.</p><pre><code class="language-julia hljs">adf_test(ssn)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(statistic = -2.797132361154919, pvalue = 0.058684558849522395, lags = 10, criterion_value = 2480.302513248841)</code></pre><p>Based upon the significance level of 0.05 and the p-value of ADF test, the null hypothesis can not be rejected. Hence, the series is non-stationary.</p><p>It is always better to apply both the tests, so that it can be ensured that the series is truly stationary. Possible outcomes of applying these stationary tests are as follows:</p><p>Case 1: Both tests conclude that the series is not stationary - The series is not stationary Case 2: Both tests conclude that the series is stationary - The series is stationary Case 3: KPSS indicates stationarity and ADF indicates non-stationarity - The series is trend stationary. Trend needs to be removed to make series strict stationary. The detrended series is checked for stationarity. Case 4: KPSS indicates non-stationarity and ADF indicates stationarity - The series is difference stationary. Differencing is to be used to make series stationary. The differenced series is checked for stationarity. Here, due to the difference in the results from ADF test and KPSS test, it can be inferred that the series is trend stationary and not strict stationary. The series can be detrended by differencing or by model fitting.</p><h2 id="Detrending-by-Differencing"><a class="docs-heading-anchor" href="#Detrending-by-Differencing">Detrending by Differencing</a><a id="Detrending-by-Differencing-1"></a><a class="docs-heading-anchor-permalink" href="#Detrending-by-Differencing" title="Permalink"></a></h2><p>It is one of the simplest methods for detrending a time series. A new series is constructed where the value at the current time step is calculated as the difference between the original observation and the observation at the previous time step.</p><p>Differencing is applied on the data and the result is plotted.</p><pre><code class="language-julia hljs">y = difference(ssn)
ssn_diff = y.series</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">308-element Vector{Float64}:
   6.0
   5.0
   7.0
  13.0
  22.0
 -29.0
  -9.0
 -10.0
  -2.0
  -5.0
   ⋮
  26.299999999999997
  -8.599999999999994
  -7.0
 -40.3
 -23.300000000000004
 -10.599999999999998
 -14.600000000000001
  -7.699999999999999
  -4.6</code></pre><p>This applies auto differencing on the data till it passes the KPSS test</p><pre><code class="language-julia hljs">years = years[1:end-1]
plot(
    years,
    ssn_diff,
    xlabel = &quot;Year&quot;,
    ylabel = &quot;Sunspot Number (SSN)&quot;,
    title = &quot;Yearly Sunspot Activity&quot;,
    lw = 2,
    legend = false,
    size = (1200, 800)
)</code></pre><img src="3c323c7f.svg" alt="Example block output"/><p>ADF test is now applied on these detrended values and stationarity is checked.</p><pre><code class="language-julia hljs">adf_test(ssn_diff)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(statistic = -8.537650234731007, pvalue = 9.97895058035024e-14, lags = 10, criterion_value = 2480.7566758307266)</code></pre><p>Based upon the p-value of ADF test, the series is strict stationary now.</p><p>KPSS test is now applied on these detrended values and stationarity is checked.</p><pre><code class="language-julia hljs">kpss_test(ssn_diff)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(statistic = 0.016238191204872725, pvalue = 0.8162966976355759, lags = 5, critical_values = Dict(&quot;5%&quot; =&gt; 0.463, &quot;10%&quot; =&gt; 0.347, &quot;1%&quot; =&gt; 0.739))</code></pre><p>Based upon the p-value of KPSS test, the null hypothesis can not be rejected. Hence, the series is stationary.</p><h2 id="Conclusion"><a class="docs-heading-anchor" href="#Conclusion">Conclusion</a><a id="Conclusion-1"></a><a class="docs-heading-anchor-permalink" href="#Conclusion" title="Permalink"></a></h2><p>Two tests for checking the stationarity of a time series are used, namely ADF test and KPSS test. Detrending is carried out by using differencing. Trend stationary time series is converted into strict stationary time series. Requisite forecasting model can now be applied on a stationary time series data.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../arma_sunspots/">« Autoregressive Moving Average (ARMA): Sunspots data</a><a class="docs-footer-nextpage" href="../../api/">API Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.9.0 on <span class="colophon-date" title="Sunday 31 August 2025 08:54">Sunday 31 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
