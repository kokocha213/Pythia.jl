<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Autoregressive Moving Average (ARMA): Artificial data · Pythia.jl</title><meta name="title" content="Autoregressive Moving Average (ARMA): Artificial data · Pythia.jl"/><meta property="og:title" content="Autoregressive Moving Average (ARMA): Artificial data · Pythia.jl"/><meta property="twitter:title" content="Autoregressive Moving Average (ARMA): Artificial data · Pythia.jl"/><meta name="description" content="Documentation for Pythia.jl."/><meta property="og:description" content="Documentation for Pythia.jl."/><meta property="twitter:description" content="Documentation for Pythia.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Pythia.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Autoregressive Moving Average (ARMA): Artificial data</a><ul class="internal"><li><a class="tocitem" href="#Step-1.-Simulate-ARMA(1,1)-data"><span>Step 1. Simulate ARMA(1,1) data</span></a></li><li><a class="tocitem" href="#Step-2.-Train-test-split"><span>Step 2. Train-test split</span></a></li><li><a class="tocitem" href="#Step-3.-Fit-ARIMA(1,0,1)-model"><span>Step 3. Fit ARIMA(1,0,1) model</span></a></li><li><a class="tocitem" href="#Step-4.-Forecast-next-5-values"><span>Step 4. Forecast next 5 values</span></a></li><li class="toplevel"><a class="tocitem" href="#Forecast-Plot-(Last-50-points)"><span>Forecast Plot (Last 50 points)</span></a></li></ul></li><li><a class="tocitem" href="../arma_sunspots/">Autoregressive Moving Average (ARMA): Sunspots data</a></li><li><a class="tocitem" href="../stationarity_sun/">Stationarity and detrending (ADF/KPSS)</a></li></ul></li><li><a class="tocitem" href="../../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Autoregressive Moving Average (ARMA): Artificial data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Autoregressive Moving Average (ARMA): Artificial data</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ababii/Pythia.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Autoregressive-Moving-Average-(ARMA):-Artificial-data"><a class="docs-heading-anchor" href="#Autoregressive-Moving-Average-(ARMA):-Artificial-data">Autoregressive Moving Average (ARMA): Artificial data</a><a id="Autoregressive-Moving-Average-(ARMA):-Artificial-data-1"></a><a class="docs-heading-anchor-permalink" href="#Autoregressive-Moving-Average-(ARMA):-Artificial-data" title="Permalink"></a></h1><p>In this example, we will:</p><ol><li>Generate artificial ARMA(1,1) data.  </li><li>Split the data into training and test sets.  </li><li>Fit an ARIMA(1,0,1) model (equivalent to ARMA(1,1)).  </li><li>Forecast the next 5 values with 95% prediction intervals.</li></ol><hr/><h2 id="Step-1.-Simulate-ARMA(1,1)-data"><a class="docs-heading-anchor" href="#Step-1.-Simulate-ARMA(1,1)-data">Step 1. Simulate ARMA(1,1) data</a><a id="Step-1.-Simulate-ARMA(1,1)-data-1"></a><a class="docs-heading-anchor-permalink" href="#Step-1.-Simulate-ARMA(1,1)-data" title="Permalink"></a></h2><p>We define a helper function to generate an ARMA(1,1) series:</p><pre><code class="language-julia hljs">using Random, Pythia

function simulate_arma(rng::AbstractRNG, ϕ::Float64, θ::Float64, σ::Float64, n::Int)
    ε = randn(rng, n) .* σ
    y = zeros(n)
    y[1] = 5
    for t in 2:n
        y[t] = ϕ * y[t-1] + ε[t] + θ * ε[t-1]
    end
    return y
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">simulate_arma (generic function with 1 method)</code></pre><p>Now generate 2000 data points with parameters ϕ = 0.6, θ = 0.3, and σ = 1:</p><pre><code class="language-julia hljs">using Random
rng = Random.MersenneTwister(40)
ϕ, θ, σ = 0.6, 0.3, 1.0

y = simulate_arma(rng, ϕ, θ, σ, 2000)

length(y)  # confirm we generated 2000 values</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2000</code></pre><hr/><h2 id="Step-2.-Train-test-split"><a class="docs-heading-anchor" href="#Step-2.-Train-test-split">Step 2. Train-test split</a><a id="Step-2.-Train-test-split-1"></a><a class="docs-heading-anchor-permalink" href="#Step-2.-Train-test-split" title="Permalink"></a></h2><p>We’ll keep the first 1995 points for training, and the last 5 points for testing:</p><pre><code class="language-julia hljs">y_train = y[1:1995]
y_test  = y[1996:2000]

(size(y_train), size(y_test))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">((1995,), (5,))</code></pre><hr/><h2 id="Step-3.-Fit-ARIMA(1,0,1)-model"><a class="docs-heading-anchor" href="#Step-3.-Fit-ARIMA(1,0,1)-model">Step 3. Fit ARIMA(1,0,1) model</a><a id="Step-3.-Fit-ARIMA(1,0,1)-model-1"></a><a class="docs-heading-anchor-permalink" href="#Step-3.-Fit-ARIMA(1,0,1)-model" title="Permalink"></a></h2><p>An ARMA(1,1) is equivalent to ARIMA with order (p=1, d=0, q=1).   We fit the model on the training data:</p><pre><code class="language-julia hljs">using Pythia
model = Pythia.ARIMAModel(y_train; p=1, q=1, P=0, Q=0, seasonal=false, stationary=true, approximation=false)
fitted_model = fit(model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ARIMAModel([5.0, 4.054313254826956, 2.2627312139701, -0.3767165960938693, -0.4841809151640614, 1.1818989333830259, 3.1755475273904663, 2.488566454003891, 0.9715468870330275, 0.7896965292068018  …  0.25767795590430354, -0.1655688163540757, -0.34281408102756106, 0.7230950476979987, -1.7421891170373534, 0.41696800059368133, 0.2072101036319241, -0.27734831508493507, 0.0814403961601945, -0.3517809374425012], 5, 1, 0, 1, 0, 0, 0, 1, 5, 5, 2, 2, 2, 1, true, true, false, true, false, 5726.268200775222, false, &quot;aicc&quot;, Pythia.sse_arima_loss_, Pythia.var&quot;#3#5&quot;(), (params = [0.008893430148539522, 0.6341478342179294, 0.28861290583983595], loglik = -2860.128073265562, sigma2 = 1.0298562687912018, residuals = [4.9911065698514605, -0.5658171168923571, -0.15389406368777617, -1.776100312086424, 0.25842514034857916, 1.40546295125736, 2.0115207019599817, -0.11464439804507065, -0.5823777173714254, 0.3327804701120344  …  -0.05673078724708068, -0.3214949268070709, -0.15392481983258324, 0.9760211141052518, -2.49132399552024, 2.231908283548033, -0.710260216314077, -0.21265331874689575, 0.3098012916067849, -0.5017322694374469]))</code></pre><hr/><h2 id="Step-4.-Forecast-next-5-values"><a class="docs-heading-anchor" href="#Step-4.-Forecast-next-5-values">Step 4. Forecast next 5 values</a><a id="Step-4.-Forecast-next-5-values-1"></a><a class="docs-heading-anchor-permalink" href="#Step-4.-Forecast-next-5-values" title="Permalink"></a></h2><p>Finally, we forecast the next 5 points, with 95% prediction intervals:</p><pre><code class="language-julia hljs">res   = predict(fitted_model, h=5, level=0.95)
preds = res.fittedvalues
lower = res.lower
upper = res.upper</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5-element Vector{Float64}:
 1.6300133049639198
 2.487667970542199
 2.816252951202218
 2.9636959753355363
 3.03531228121628</code></pre><h1 id="Forecast-Plot-(Last-50-points)"><a class="docs-heading-anchor" href="#Forecast-Plot-(Last-50-points)">Forecast Plot (Last 50 points)</a><a id="Forecast-Plot-(Last-50-points)-1"></a><a class="docs-heading-anchor-permalink" href="#Forecast-Plot-(Last-50-points)" title="Permalink"></a></h1><pre><code class="language-julia hljs">using Plots

window = 50
y_last = y_train[end-window+1:end]
x_last = (length(y_train)-window+1):length(y_train)

h = length(preds)
x_forecast = length(y_train)+1 : length(y_train)+h

# Plot last 50 points of y_train
plt = plot(x_last, y_last, label=&quot;y_train (last 50)&quot;, color=:blue)

# Plot forecast
plot!(plt, x_forecast, preds, label=&quot;Forecast&quot;, color=:red, lw=2)

# Plot upper and lower as light red lines
plot!(plt, x_forecast, lower, label=&quot;Lower 95%&quot;, color=:red, alpha=0.3, lw=2, linestyle=:dash)
plot!(plt, x_forecast, upper, label=&quot;Upper 95%&quot;, color=:red, alpha=0.3, lw=2, linestyle=:dash)

xlabel!(&quot;Time&quot;)
ylabel!(&quot;Value&quot;)
title!(&quot;Forecast vs Observed (last 50 points)&quot;)
plt</code></pre><img src="2f444edb.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../arma_sunspots/">Autoregressive Moving Average (ARMA): Sunspots data »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.9.0 on <span class="colophon-date" title="Sunday 31 August 2025 08:54">Sunday 31 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
